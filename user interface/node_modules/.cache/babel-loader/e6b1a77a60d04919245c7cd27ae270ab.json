{"ast":null,"code":"var _jsxFileName = \"/Users/samarth/Documents/Programming/RUHacks/user interface/src/components/mainPage.js\";\nimport React from 'react';\nimport './mainPage.css';\nimport logo from '../logo.png';\nimport axios from 'axios';\nimport { resolve } from 'dns';\n\nclass Helper extends React.Component {\n  constructor(props) {\n    super(props);\n  }\n\n  componentDidMount() {\n    this.props.updateTable(this.props.bills);\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 17\n      },\n      __self: this\n    });\n  }\n\n}\n\nexport class MainPage extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.onChangeHandler = event => {\n      this.setState({\n        selectedFile: event.target.files[0],\n        loaded: 0\n      });\n    };\n\n    this.onClickHandler = () => {\n      // const data = new FormData();\n      // data.append('file', this.setState.selectedFile);\n      // axios.post(\"http://localhost:1111/api/upload\", data, {\n      //     headers: {\n      //         'Content-Type': 'multipart/form-data',\n      //     }\n      // }).then(result => {\n      //     console.log(\"success\");\n      // })\n      // var xhr = new XMLHttpRequest();\n      // xhr.withCredentials = true;\n      // xhr.addEventListener(\"readystatechange\", function () {\n      //     if (this.readyState === 4) {\n      //       console.log(this.responseText);\n      //     }\n      //   });\n      //   xhr.open(\"POST\", \"http://localhost:1111/api/upload\");\n      //   xhr.setRequestHeader(\"cache-control\", \"no-cache\");\n      //   xhr.setRequestHeader(\"Postman-Token\", \"7a210a60-a3a1-44c7-9cfa-155669b8be3a\");\n      //   xhr.send(data);\n      return new Promise((resolve, reject) => {\n        const req = new XMLHttpRequest();\n        const formData = new FormData();\n        formData.append(\"file\", this.state.selectedFile, this.state.selectedFile.name);\n        req.open(\"POST\", \"http://localhost:1111/api/upload\");\n        req.send(formData);\n      });\n    };\n\n    this.state = {\n      selectedFile: null\n    };\n    this.onChangeHandler = this.onChangeHandler.bind(this);\n    this.onClickHandler = this.onClickHandler.bind(this);\n    this.onProcessHandler = this.onProcessHandler.bind(this);\n    this.updateTable = this.updateTable.bind(this);\n  } // <div>\n  //             <p>{this.props.usn}</p>\n  //         </div>\n\n\n  onProcessHandler() {\n    axios.get('http://localhost:1111/api/analyse').then(res => {\n      const obj = res.data;\n      const vendor = obj[1].description;\n      let date; // Date\n\n      let regex = /[0-9]+\\/[0-9][0-9]\\/[0-9][0-9][0-9][0-9]?$/;\n\n      for (var i in obj) {\n        if (regex.test(obj[i].description)) {\n          date = regex.exec(obj[i].description);\n          break;\n        }\n      }\n\n      if (!date) {\n        regex = /[0-9]+\\/[0-9][0-9]\\/[0-9][0-9]?$/;\n\n        for (var i in obj) {\n          if (regex.test(obj[i].description)) {\n            date = regex.exec(obj[i].description);\n            break;\n          }\n        }\n      }\n\n      let type;\n\n      for (var i in obj) {\n        if (/[dD][eE][bB][iI][tT]/.test(obj[i].description)) {\n          type = \"Debit\";\n          break;\n        } else if (/[cC][rR][eE][dD][iI][tT]/.test(obj[i].description) || /[vV][iI][sS][aA]/.test(obj[i].description) || /[cC][aA][rR][dD]/.test(obj[i].description)) {\n          type = \"Credit\";\n          break;\n        }\n      }\n\n      if (!type) type = \"Cash\";\n      let value; //regex = /^[0-9]+\\.([0-9][0-9])?$/;\n\n      regex = /[0-9]+\\.[0-9][0-9]/;\n      var arr = [];\n\n      for (var i in obj) {\n        if (regex.test(obj[i].description)) {\n          let match = regex.exec(obj[i].description);\n          arr.push(match);\n        }\n      }\n\n      arr.sort((a, b) => {\n        return a - b;\n      });\n      value = arr[arr.length - 1];\n      let bill = {\n        vendor: vendor,\n        date: date,\n        transaction_type: type,\n        total: parseInt(value, 10) // this.props.usn\n\n      };\n      axios.put('http://localhost:1111/api/' + this.props.usn + '/addbill', bill).then(res => {\n        this.updateTable(res.data.bills);\n      });\n    });\n  }\n\n  updateTable(bills) {\n    var table = document.getElementById('table');\n\n    for (var i in bills) {\n      var tr = document.createElement('tr');\n      tr.innerHTML = '<td>' + bills[i].vendor + '</td><td>' + bills[i].date + '</td><td>' + bills[i].transaction_type + '</td><td>' + bills[i].total + '</td>';\n      table.appendChild(tr);\n    }\n  }\n\n  render() {\n    var bills;\n    axios.get('http://localhost:1111/api' + this.props.usn + '/getbills', {}).then(res => {\n      bills = res.data;\n    });\n    return React.createElement(\"html\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }, React.createElement(\"head\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, React.createElement(\"link\", {\n      href: \"https://fonts.googleapis.com/css?family=Montserrat&display=swap\",\n      rel: \"stylesheet\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    })), React.createElement(\"body\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, React.createElement(\"ul\", {\n      className: \"navbar\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, React.createElement(\"li\", {\n      className: \"navelement\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, \"About\"), React.createElement(\"li\", {\n      className: \"navelement\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, \"History\"), React.createElement(\"li\", {\n      className: \"navelement\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, \"Stats\"), React.createElement(\"li\", {\n      className: \"navelement\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, \"Home\"), React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      className: \"logo\",\n      src: logo,\n      alt: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    })))), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"upload\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"file\",\n      name: \"file\",\n      onChange: this.onChangeHandler,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      onClick: this.onClickHandler,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    }, \"Upload\"), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }, \"Your current upload:\"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198\n      },\n      __self: this\n    }, \"Total:\")))), React.createElement(\"div\", {\n      className: \"process\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      onClick: this.onProcessHandler,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }, \"Process\")), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206\n      },\n      __self: this\n    }, React.createElement(\"table\", {\n      id: \"table\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208\n      },\n      __self: this\n    }, React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209\n      },\n      __self: this\n    }, \"Vendor\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }, \"Date\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211\n      },\n      __self: this\n    }, \"Transaction Type\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }, \"Total \")))), React.createElement(Helper, {\n      updateTable: this.updateTable,\n      bills: bills,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216\n      },\n      __self: this\n    })));\n  }\n\n}","map":{"version":3,"sources":["/Users/samarth/Documents/Programming/RUHacks/user interface/src/components/mainPage.js"],"names":["React","logo","axios","resolve","Helper","Component","constructor","props","componentDidMount","updateTable","bills","render","MainPage","onChangeHandler","event","setState","selectedFile","target","files","loaded","onClickHandler","Promise","reject","req","XMLHttpRequest","formData","FormData","append","state","name","open","send","bind","onProcessHandler","get","then","res","obj","data","vendor","description","date","regex","i","test","exec","type","value","arr","match","push","sort","a","b","length","bill","transaction_type","total","parseInt","put","usn","table","document","getElementById","tr","createElement","innerHTML","appendChild"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './mainPage.css';\nimport logo from '../logo.png';\nimport axios from 'axios';\nimport { resolve } from 'dns';\n\nclass Helper extends React.Component {\n    constructor(props) {\n        super(props);\n    }\n\n    componentDidMount() {\n        this.props.updateTable(this.props.bills);\n    }\n\n    render() {\n       return <div></div>;\n    }\n}\n\nexport class MainPage extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            selectedFile: null\n        };\n        this.onChangeHandler = this.onChangeHandler.bind(this);\n        this.onClickHandler = this.onClickHandler.bind(this);\n        this.onProcessHandler = this.onProcessHandler.bind(this);\n        this.updateTable = this.updateTable.bind(this);\n    }\n    \n    // <div>\n    //             <p>{this.props.usn}</p>\n    //         </div>\n    onChangeHandler = event => {\n        this.setState({\n            selectedFile: event.target.files[0],\n            loaded: 0,\n        })\n    }\n\n    onClickHandler = () => {\n        // const data = new FormData();\n        // data.append('file', this.setState.selectedFile);\n\n        // axios.post(\"http://localhost:1111/api/upload\", data, {\n        //     headers: {\n        //         'Content-Type': 'multipart/form-data',\n        //     }\n        // }).then(result => {\n        //     console.log(\"success\");\n        // })\n\n        // var xhr = new XMLHttpRequest();\n        // xhr.withCredentials = true;\n\n        // xhr.addEventListener(\"readystatechange\", function () {\n        //     if (this.readyState === 4) {\n        //       console.log(this.responseText);\n        //     }\n        //   });\n          \n        //   xhr.open(\"POST\", \"http://localhost:1111/api/upload\");\n        //   xhr.setRequestHeader(\"cache-control\", \"no-cache\");\n        //   xhr.setRequestHeader(\"Postman-Token\", \"7a210a60-a3a1-44c7-9cfa-155669b8be3a\");\n          \n        //   xhr.send(data);\n\n        return new Promise((resolve, reject) => {\n            const req = new XMLHttpRequest();\n\n            const formData = new FormData();\n            formData.append(\"file\", this.state.selectedFile, this.state.selectedFile.name)\n\n            req.open(\"POST\", \"http://localhost:1111/api/upload\");\n            req.send(formData);\n        });\n    }\n\n    onProcessHandler() {\n        axios.get('http://localhost:1111/api/analyse')\n        .then(res => {\n            const obj = res.data;\n            const vendor = obj[1].description;\n            let date;\n            \n            // Date\n            let regex = /[0-9]+\\/[0-9][0-9]\\/[0-9][0-9][0-9][0-9]?$/;\n\n            for (var i in obj){\n                if(regex.test(obj[i].description)){\n                    date = regex.exec(obj[i].description);\n                    break;\n                }\n            }\n\n            if (!date) {\n                regex = /[0-9]+\\/[0-9][0-9]\\/[0-9][0-9]?$/;\n                for (var i in obj){\n                    if(regex.test(obj[i].description)){\n                        date = regex.exec(obj[i].description);\n                        break;\n                    }\n                }\n            }\n            \n            let type;\n\n            for (var i in obj){\n                if(/[dD][eE][bB][iI][tT]/.test(obj[i].description)){\n                    type = \"Debit\";\n                    break;\n                }else if(/[cC][rR][eE][dD][iI][tT]/.test(obj[i].description) || /[vV][iI][sS][aA]/.test(obj[i].description) || /[cC][aA][rR][dD]/.test(obj[i].description)){\n                    type = \"Credit\";\n                    break;\n                } \n            }\n            if (!type) type=\"Cash\";\n\n            let value;\n\n            //regex = /^[0-9]+\\.([0-9][0-9])?$/;\n            regex = /[0-9]+\\.[0-9][0-9]/;\n            var arr = [];\n        \n            for (var i in obj){\n                if(regex.test(obj[i].description)){\n                    let match = regex.exec(obj[i].description);\n                    arr.push(match);\n                }\n            }\n\n            arr.sort((a, b) => {return a-b});\n            \n            value = arr[arr.length - 1];\n            \n            let bill = {\n                vendor: vendor,\n                date: date,\n                transaction_type: type,\n                total: parseInt(value, 10)\n            }\n\n            // this.props.usn\n            axios.put('http://localhost:1111/api/' + this.props.usn + '/addbill', bill)\n                .then(res => {\n                    this.updateTable(res.data.bills)\n                });\n       \n        })\n    }\n\n    updateTable(bills){\n        var table = document.getElementById('table')\n        for (var i in bills){\n            var tr = document.createElement('tr');\n            tr.innerHTML = '<td>' + bills[i].vendor + '</td><td>' + bills[i].date + '</td><td>' + bills[i].transaction_type + '</td><td>' + bills[i].total + '</td>'\n            table.appendChild(tr)\n        }\n    }\n\n\n    render() {\n        var bills;\n        axios.get('http://localhost:1111/api' + this.props.usn + '/getbills', {})\n            .then(res => {\n                bills = res.data;\n            })\n\n        return(\n            <html>\n                <head>\n                <link href=\"https://fonts.googleapis.com/css?family=Montserrat&display=swap\" rel=\"stylesheet\"/>\n                </head>\n                <body>\n                    <div>\n                        <ul className=\"navbar\">\n                            <li className=\"navelement\">About</li>\n                            <li className=\"navelement\">History</li>\n                            <li className=\"navelement\">Stats</li>\n                            <li className=\"navelement\">Home</li>\n                            <li><img className=\"logo\" src={logo} alt=\"\"/></li>\n                        </ul>\n                    </div>\n                    <div>\n                        <div className=\"upload\">\n                           \n                            <input type=\"file\" name=\"file\" onChange={this.onChangeHandler}/>\n                            <button onClick={this.onClickHandler}>Upload</button>\n                           \n                            \n\n                            <div>\n                                <p>Your current upload:</p>\n                                {/* Add image here*/}\n                                <p>Total:</p>\n                            </div>\n                        </div>\n                    </div>\n                    <div className=\"process\">\n                        <button onClick={this.onProcessHandler}>Process</button>\n                    </div>\n\n                    <div>\n                        <table id=\"table\">\n                            <tr>\n                                <th>Vendor</th>\n                                <th>Date</th>\n                                <th>Transaction Type</th>\n                                <th>Total </th>\n                            </tr>\n                        </table>\n                    </div>\n                    <Helper updateTable={this.updateTable} bills={bills}/>\n                </body>\n            </html>\n\n        )\n    }\n}"]},"metadata":{},"sourceType":"module"}